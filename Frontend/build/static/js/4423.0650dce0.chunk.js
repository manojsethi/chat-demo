"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[4423,1238],{14423:function(e,t,n){n.r(t);var s=n(1413),r=n(93433),a=n(74165),i=n(15861),c=n(29439),l=n(29529),o=n(46379),d=n(2641),u=n(20043),x=n(86215),m=n(47646),f=n(75308),h=n(61994),p=n(7477),g=n(72791),v=n(23853),j=n(5796),w=n(96136),y=n(95364),Z=n(51468),N=n(76421),_=n(81238),b=n(16856),S=n(80184);t.default=function(e){var t,n,k=e.selectedUser,C=e.setSelectedUser,U=localStorage.getItem("loggedInUser")?JSON.parse(localStorage.getItem("loggedInUser")):null,D=(0,g.useRef)(),L=(0,g.useState)([]),M=(0,c.Z)(L,2),I=M[0],T=M[1],R=(0,g.useContext)(y.SocketContext).socket,F=(0,g.useContext)(w.ChatContext).messageInfo,E=(0,g.useState)(""),z=(0,c.Z)(E,2),A=z[0],P=z[1],B=(0,g.useState)(!1),O=(0,c.Z)(B,2),G=O[0],H=O[1],K=(0,g.useState)(),q=(0,c.Z)(K,2),J=q[0],W=q[1],Q=(0,g.useState)(!1),V=(0,c.Z)(Q,2),X=V[0],Y=V[1],$=(0,g.useState)(!1),ee=(0,c.Z)($,2),te=ee[0],ne=ee[1],se=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),e.next=3,Z.default.getChats(t);case 3:(n=e.sent).statusCode===p.WE.Ok&&T(n.data),H(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n,s,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.file,s=t.onSuccess,r=t.onError,ne(!0);try{W(n),s()}catch(a){r(a)}ne(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!J){e.next=8;break}return(t=new FormData).append("file",J),e.next=5,Z.default.uploadImage(t);case 5:if(!(n=e.sent)){e.next=8;break}return e.abrupt("return",n.data.uploadedFileUrl);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(""),e.next=3,ae();case 3:i=e.sent,T((function(e){return[].concat((0,r.Z)(e),[(0,s.Z)((0,s.Z)({},i&&{message_type:"file",file_url:i}),{},{message:n,sent_from:U._id,__v:0,date:(new Date).toString(),_id:Math.random().toString(),isReaded:!1,sent_to:t,chatType:"Personal"})])})),i&&W(void 0),R.mySocket.emit("personalMessage",(0,s.Z)((0,s.Z)({message:n},i&&{message_type:"file",file_url:i}),{},{sent_to:t,chatType:"Personal"}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,g.useEffect)((function(){k&&se(k._id)}),[k]),(0,g.useEffect)((function(){F.message&&F.sentBy.id.toString()===k._id&&T((function(e){return[].concat((0,r.Z)(e),[(0,s.Z)((0,s.Z)({},(null===F||void 0===F?void 0:F.file_url)&&{message_type:"file",file_url:F.file_url}),{},{message:null===F||void 0===F?void 0:F.message,sent_from:F.sentBy.id,__v:0,date:(new Date).toString(),_id:Math.random().toString(),isReaded:!0,sent_to:U._id,chatType:"Personal"})])}))}),[F.message]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"bg-[#00A038] rounded-xl py-4",children:(0,S.jsxs)("div",{className:"flex justify-between px-6",children:[(0,S.jsxs)("div",{className:"text-white flex gap-4 items-center",children:[(0,S.jsx)(o.C,{size:"large",src:null!==(t=null===k||void 0===k?void 0:k.profile)&&void 0!==t?t:(0,S.jsx)(l.Z,{})}),(0,S.jsx)("p",{className:"font-semibold",children:null===k||void 0===k?void 0:k.name})]}),(0,S.jsx)("div",{children:(0,S.jsx)(d.ZP,{onClick:function(){return C(null)},type:"primary",className:"text-white mt-2 text-base font-medium",children:"Go Back"})})]})}),(0,S.jsx)("div",{children:(0,S.jsxs)(u.Z,{spinning:te,children:[G?(0,S.jsx)(j.default,{}):(0,S.jsxs)("div",{className:"shadow-3xl dark:shadow bg-white  mt-6   dark: dark:bg-navy-900 overflow-y-auto overflow-x-hidden ",children:[(0,S.jsx)("div",{className:"flex justify-center mt-2 py-4",children:(0,S.jsx)("p",{className:"text-center text-white bg-[#00A038] px-10 rounded-2xl  ",children:(0,_.formatDate)(null===I||void 0===I||null===(n=I[0])||void 0===n?void 0:n.date)})}),(0,S.jsx)("div",{className:"overflow-y-auto max-h-[500px]",style:{minHeight:"49vh"},children:I&&I.length>0?I.map((function(e){return e.sent_from.toString()!==U._id.toString()?e.file_url?(0,S.jsx)("div",{className:"flex mb-3 px-3",children:(0,S.jsxs)("div",{className:"bg-[#00A038] p-4 rounded-xl text-white flex flex-col gap-3",children:[(0,S.jsx)(x.Z,{src:e.file_url,width:200,height:200}),(0,S.jsxs)("div",{children:[" ",e.message]}),(0,S.jsx)("div",{className:"text-end",children:(0,S.jsx)("p",{className:"text-gray-800 text-xs",children:(0,_.formatTime)(e.date)})})]})},e._id):(0,S.jsx)("div",{className:"flex mb-3 px-6",children:(0,S.jsx)("div",{className:"bg-[#00A038] px-6 py-1 rounded-xl text-white flex flex-col gap-4",children:(0,S.jsxs)("div",{children:[" ",e.message," ",(0,S.jsx)("div",{className:"text-end",children:(0,S.jsx)("p",{className:"text-gray-800 text-xs",children:(0,_.formatTime)(e.date)})})]})})},e._id):e.file_url?(0,S.jsxs)("div",{className:"flex justify-between mb-3 px-3 ",children:[(0,S.jsx)("div",{}),(0,S.jsxs)("div",{className:"bg-brandLinear text-white p-4 rounded-xl flex flex-col gap-3",children:[(0,S.jsx)(x.Z,{src:e.file_url,width:200,height:200}),(0,S.jsxs)("div",{children:[e.message,(0,S.jsx)("div",{className:"text-end",children:(0,S.jsx)("p",{className:"text-gray-800 text-xs",children:(0,_.formatTime)(e.date)})})]})]})]},e._id):(0,S.jsxs)("div",{className:"flex justify-between px-3 py-1 mb-3 ",children:[(0,S.jsx)("div",{}),(0,S.jsx)("div",{className:"text-black shadow-xl bg-brandLinear text-white px-6 rounded-xl",children:e.message&&(0,S.jsxs)(S.Fragment,{children:[e.message,(0,S.jsx)("div",{className:"text-end",children:(0,S.jsx)("p",{className:"text-gray-800 text-xs",children:(0,_.formatTime)(e.date)})})]})})]},e._id)})):(0,S.jsx)("div",{className:"text-center mt-10 text-xl  dark:text-white font-medium pb-4",children:(0,S.jsx)("p",{children:"No Chats Found"})})}),(0,S.jsx)(N.ZP,{open:X,className:"m-10",onEmojiClick:function(e){P((function(t){return t+e.emoji}))}}),J&&(0,S.jsx)(m.Z,{title:(0,S.jsxs)("div",{className:"flex justify-between align-middle",children:[(0,S.jsx)("div",{children:"Seletecd Media"})," ",(0,S.jsx)(b.FU5,{className:"border  cursor-pointer",size:"25px",onClick:function(){W(void 0)}})]}),className:"mt-5 mx-5 shadow-2xl",children:(0,S.jsx)("div",{children:(0,S.jsx)(x.Z,{src:URL.createObjectURL(J),width:100,height:100})})})]}),(0,S.jsx)(f.Z,{prefix:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h.Z,{id:"file",ref:D,accept:"image/*",showUploadList:!1,customRequest:re,style:{display:"none"},multiple:!1,children:(0,S.jsx)(v.UH,{className:"cursor-pointer"})}),(0,S.jsx)(v.jMy,{onClick:function(){Y(!X)},className:"cursor-pointer"})]}),value:A,onKeyDown:function(e){"escape"===e.code.toLowerCase()&&Y(!1),"enter"!==e.code.toLowerCase()||e.shiftKey||(A||J)&&ie(k._id,A)},onChange:function(e){return P(e.target.value)},placeholder:"Type here . . . . .",suffix:(0,S.jsx)(v.LbG,{onClick:function(){return(A||J)&&ie(k._id,A)},className:"cursor-pointer"}),size:"large",className:"rounded-none w-full"})]})})]})})}},81238:function(e,t,n){function s(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function r(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:200)/Math.max(e,t);return{width:Math.ceil(e*n),height:Math.ceil(t*n)}}function a(e,t){var n=new Image;n.onload=function(){var e=n.width,s=n.height;t(e,s)},n.src=e}function i(e){var t=new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"}).split(" ");return t[4]+" "+t[5]}n.r(t),n.d(t,{formatDate:function(){return s},formatTime:function(){return i},getImageDimensions:function(){return a},scaleImageRatio:function(){return r}})},29529:function(e,t,n){n.d(t,{Z:function(){return l}});var s=n(87462),r=n(72791),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"},i=n(54291),c=function(e,t){return r.createElement(i.Z,(0,s.Z)({},e,{ref:t,icon:a}))};var l=r.forwardRef(c)}}]);
//# sourceMappingURL=4423.0650dce0.chunk.js.map